# Linked Server Exploitation

**Identifying MSSQL Listeners**

<figure><img src="../../../.gitbook/assets/image (35).png" alt=""><figcaption></figcaption></figure>

{% code overflow="wrap" %}
```powershell
 New-NetFirewallRule -DisplayName "Allow SQL Server" -Direction Inbound -Protocol TCP -LocalPort 1433 -Action Allow
```
{% endcode %}

NMap can be used to identify the server on a network;

<figure><img src="../../../.gitbook/assets/image (36).png" alt=""><figcaption></figcaption></figure>

**case** 1 : **Brute Force Attacks**

SQL Server supports two types of authentication, Windows Authentication, and SQL Server authentication. This can be configured using SQL Server Management Studio;

<figure><img src="../../../.gitbook/assets/image (37).png" alt=""><figcaption></figcaption></figure>

using&#x20;

```
crackmapexec mssql 192.168.16  -u sa -p  /usr/share/wordlists/rockyou.txt 
```

>
>
> **MSSQL** supports a feature called Linked Servers. Essentially the MSSQL database is configured to connect to remote databases running on other systems. This allows you to execute a query against one host, but the data to be retrieved from multiple systems.
>
> If linked servers are configured, and attacker may be able to exploit this feature to move laterally between different database systems.
>
> To configure a linked server, in SQL Management Studio, select <mark style="color:red;">**SERVER1**</mark> > **Linked** <mark style="color:red;">**Servers**</mark> > Right click and select new Linked Server.
>
> On the general tab, set the data source to the target SQL server hostname.

<figure><img src="../../../.gitbook/assets/image (34).png" alt=""><figcaption></figcaption></figure>

In the security tab, set the user account used to login to the remote server.
